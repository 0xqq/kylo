package com.thinkbiganalytics.nifi;

import org.apache.commons.io.IOUtils;
import org.apache.nifi.annotation.behavior.InputRequirement;
import org.apache.nifi.annotation.documentation.CapabilityDescription;
import org.apache.nifi.annotation.documentation.Tags;
import org.apache.nifi.components.PropertyDescriptor;
import org.apache.nifi.flowfile.FlowFile;
import org.apache.nifi.logging.ProcessorLog;
import org.apache.nifi.processor.AbstractProcessor;
import org.apache.nifi.processor.ProcessContext;
import org.apache.nifi.processor.ProcessSession;
import org.apache.nifi.processor.Relationship;
import org.apache.nifi.processor.exception.ProcessException;
import org.apache.nifi.processor.io.InputStreamCallback;
import org.apache.nifi.processor.util.StandardValidators;
import org.codehaus.jettison.json.JSONArray;
import org.codehaus.jettison.json.JSONObject;
import org.elasticsearch.action.index.IndexRequest;
import org.elasticsearch.action.update.UpdateRequest;
import org.elasticsearch.action.update.UpdateResponse;
import org.elasticsearch.client.Client;
import org.elasticsearch.client.transport.TransportClient;
import org.elasticsearch.common.settings.Settings;
import org.elasticsearch.common.transport.InetSocketTransportAddress;

import java.io.IOException;
import java.io.InputStream;
import java.net.InetAddress;
import java.util.*;

import static org.elasticsearch.common.xcontent.XContentFactory.jsonBuilder;

/**
 * This processor copies FlowFiles to HDFS.
 */
@InputRequirement(InputRequirement.Requirement.INPUT_REQUIRED)
@Tags({"elasticsearch", "thinkbig"})
@CapabilityDescription("Write FlowFile from a JSON array to Elasticsearch")
public class IndexElasticSearch extends AbstractProcessor {
    public static final String JSON_TEST ="[{\"id\": 788, \"first_name\": \"Nicholas\", \"last_name\": \"Butler\"},{\"id\": 375, \"first_name\": \"Bruce\", \"last_name\": \"Gonzales\"},{\"id\": 744, \"first_name\": \"Heather\", \"last_name\": \"Richardson\"},{\"id\": 749, \"first_name\": \"Larry\", \"last_name\": \"Fields\"},{\"id\": 521, \"first_name\": \"Roy\", \"last_name\": \"Palmer\"},{\"id\": 314, \"first_name\": \"James\", \"last_name\": \"Harvey\"},{\"id\": 835, \"first_name\": \"Sean\", \"last_name\": \"Castillo\"},{\"id\": 821, \"first_name\": \"Juan\", \"last_name\": \"Foster\"},{\"id\": 810, \"first_name\": \"Mark\", \"last_name\": \"Kelley\"},{\"id\": 475, \"first_name\": \"Richard\", \"last_name\": \"Howell\"},{\"id\": 523, \"first_name\": \"Phillip\", \"last_name\": \"Butler\"},{\"id\": 722, \"first_name\": \"Robin\", \"last_name\": \"Spencer\"},{\"id\": 291, \"first_name\": \"Julia\", \"last_name\": \"Medina\"},{\"id\": 322, \"first_name\": \"Frances\", \"last_name\": \"Fisher\"},{\"id\": 215, \"first_name\": \"Philip\", \"last_name\": \"Fox\"},{\"id\": 795, \"first_name\": \"Clarence\", \"last_name\": \"Edwards\"},{\"id\": 589, \"first_name\": \"Gerald\", \"last_name\": \"Porter\"},{\"id\": 653, \"first_name\": \"\", \"last_name\": \"Lane\"},{\"id\": 57, \"first_name\": \"Willie\", \"last_name\": \"Palmer\"},{\"id\": 195, \"first_name\": \"Joe\", \"last_name\": \"Hayes\"},{\"id\": 655, \"first_name\": \"Johnny\", \"last_name\": \"Reed\"},{\"id\": 200, \"first_name\": \"Russell\", \"last_name\": \"Ward\"},{\"id\": 685, \"first_name\": \"Joan\", \"last_name\": \"Jackson\"},{\"id\": 222, \"first_name\": \"Sara\", \"last_name\": \"Price\"},{\"id\": 16, \"first_name\": \"Bruce\", \"last_name\": \"Willis\"},{\"id\": 550, \"first_name\": \"Cheryl\", \"last_name\": \"Evans\"},{\"id\": 17, \"first_name\": \"Emily\", \"last_name\": \"Andrews\"},{\"id\": 383, \"first_name\": \"Beverly\", \"last_name\": \"Carter\"},{\"id\": 678, \"first_name\": \"Wanda\", \"last_name\": \"Ford\"},{\"id\": 801, \"first_name\": \"Annie\", \"last_name\": \"Bradley\"},{\"id\": 643, \"first_name\": \"Thomas\", \"last_name\": \"Hunter\"},{\"id\": 428, \"first_name\": \"Dennis\", \"last_name\": \"Marshall\"},{\"id\": 832, \"first_name\": \"Anthony\", \"last_name\": \"Duncan\"},{\"id\": 648, \"first_name\": \"Eric\", \"last_name\": \"Bryant\"},{\"id\": 994, \"first_name\": \"Carol\", \"last_name\": \"Williams\"},{\"id\": 985, \"first_name\": \"Mark\", \"last_name\": \"Simpson\"},{\"id\": 104, \"first_name\": \"Carl\", \"last_name\": \"Collins\"},{\"id\": 427, \"first_name\": \"Christina\", \"last_name\": \"Moore\"},{\"id\": 472, \"first_name\": \"Joyce\", \"last_name\": \"Boyd\"},{\"id\": 781, \"first_name\": \"Philip\", \"last_name\": \"Stewart\"},{\"id\": 367, \"first_name\": \"Debra\", \"last_name\": \"Sanchez\"},{\"id\": 499, \"first_name\": \"Debra\", \"last_name\": \"Parker\"},{\"id\": 84, \"first_name\": \"Kathryn\", \"last_name\": \"Austin\"},{\"id\": 464, \"first_name\": \"Kathryn\", \"last_name\": \"Johnson\"},{\"id\": 240, \"first_name\": \"Albert\", \"last_name\": \"Wright\"},{\"id\": 116, \"first_name\": \"Mark\", \"last_name\": \"Mitchell\"},{\"id\": 545, \"first_name\": \"\", \"last_name\": \"Payne\"},{\"id\": 88, \"first_name\": \"Timothy\", \"last_name\": \"Watkins\"},{\"id\": 704, \"first_name\": \"Ernest\", \"last_name\": \"Weaver\"},{\"id\": 927, \"first_name\": \"Carlos\", \"last_name\": \"Alvarez\"},{\"id\": 553, \"first_name\": \"Keith\", \"last_name\": \"Lynch\"},{\"id\": 554, \"first_name\": \"Donna\", \"last_name\": \"Gonzalez\"},{\"id\": 891, \"first_name\": \"Jason\", \"last_name\": \"Barnes\"},{\"id\": 534, \"first_name\": \"Lillian\", \"last_name\": \"Pierce\"},{\"id\": 966, \"first_name\": \"Martha\", \"last_name\": \"Hall\"},{\"id\": 202, \"first_name\": \"\", \"last_name\": \"Reid\"},{\"id\": 555, \"first_name\": \"Harold\", \"last_name\": \"Williams\"},{\"id\": 677, \"first_name\": \"Dorothy\", \"last_name\": \"Russell\"},{\"id\": 765, \"first_name\": \"Harold\", \"last_name\": \"Robinson\"},{\"id\": 506, \"first_name\": \"Stephanie\", \"last_name\": \"Carpenter\"},{\"id\": 520, \"first_name\": \"Douglas\", \"last_name\": \"Scott\"},{\"id\": 124, \"first_name\": \"John\", \"last_name\": \"Williamson\"},{\"id\": 849, \"first_name\": \"Norma\", \"last_name\": \"Kennedy\"},{\"id\": 723, \"first_name\": \"Patricia\", \"last_name\": \"Ray\"},{\"id\": 562, \"first_name\": \"Patrick\", \"last_name\": \"Fowler\"},{\"id\": 303, \"first_name\": \"Samuel\", \"last_name\": \"Carr\"},{\"id\": 480, \"first_name\": \"Dennis\", \"last_name\": \"Freeman\"},{\"id\": 746, \"first_name\": \"Diana\", \"last_name\": \"Lawrence\"},{\"id\": 372, \"first_name\": \"Willie\", \"last_name\": \"Marshall\"},{\"id\": 117, \"first_name\": \"Mark\", \"last_name\": \"Burton\"},{\"id\": 605, \"first_name\": \"Martin\", \"last_name\": \"Reyes\"},{\"id\": 921, \"first_name\": \"Ruby\", \"last_name\": \"Young\"},{\"id\": 206, \"first_name\": \"Paul\", \"last_name\": \"Richards\"},{\"id\": 326, \"first_name\": \"Mildred\", \"last_name\": \"Cole\"},{\"id\": 842, \"first_name\": \"Paul\", \"last_name\": \"Ruiz\"},{\"id\": 651, \"first_name\": \"Angela\", \"last_name\": \"Patterson\"},{\"id\": 792, \"first_name\": \"Jimmy\", \"last_name\": \"Reid\"},{\"id\": 831, \"first_name\": \"Jose\", \"last_name\": \"Parker\"},{\"id\": 60, \"first_name\": \"Cynthia\", \"last_name\": \"Richards\"},{\"id\": 612, \"first_name\": \"Phillip\", \"last_name\": \"Daniels\"},{\"id\": 239, \"first_name\": \"Johnny\", \"last_name\": \"Turner\"},{\"id\": 54, \"first_name\": \"George\", \"last_name\": \"Ferguson\"},{\"id\": 999, \"first_name\": \"Annie\", \"last_name\": \"Daniels\"},{\"id\": 976, \"first_name\": \"Jean\", \"last_name\": \"Austin\"},{\"id\": 952, \"first_name\": \"Cheryl\", \"last_name\": \"Diaz\"},{\"id\": 411, \"first_name\": \"Dorothy\", \"last_name\": \"Payne\"},{\"id\": 516, \"first_name\": \"Kimberly\", \"last_name\": \"Lane\"},{\"id\": 453, \"first_name\": \"Jeremy\", \"last_name\": \"Bennett\"},{\"id\": 316, \"first_name\": \"Gary\", \"last_name\": \"Holmes\"},{\"id\": 898, \"first_name\": \"Ronald\", \"last_name\": \"Mendoza\"},{\"id\": 628, \"first_name\": \"Roger\", \"last_name\": \"Robinson\"},{\"id\": 413, \"first_name\": \"Dennis\", \"last_name\": \"Wallace\"},{\"id\": 601, \"first_name\": \"Johnny\", \"last_name\": \"Lee\"},{\"id\": 256, \"first_name\": \"Roy\", \"last_name\": \"Shaw\"},{\"id\": 597, \"first_name\": \"Jonathan\", \"last_name\": \"Daniels\"},{\"id\": 201, \"first_name\": \"Brian\", \"last_name\": \"Meyer\"},{\"id\": 50, \"first_name\": \"Sean\", \"last_name\": \"Alexander\"},{\"id\": 376, \"first_name\": \"Arthur\", \"last_name\": \"Gutierrez\"},{\"id\": 29, \"first_name\": \"Jacqueline\", \"last_name\": \"Holmes\"},{\"id\": 899, \"first_name\": \"Debra\", \"last_name\": \"Taylor\"},{\"id\": 660, \"first_name\": \"Sarah\", \"last_name\": \"Chavez\"},{\"id\": 784, \"first_name\": \"Melissa\", \"last_name\": \"Owens\"},{\"id\": 466, \"first_name\": \"Frances\", \"last_name\": \"Bradley\"},{\"id\": 483, \"first_name\": \"Wayne\", \"last_name\": \"Morales\"},{\"id\": 419, \"first_name\": \"Michael\", \"last_name\": \"Nelson\"},{\"id\": 331, \"first_name\": \"Ann\", \"last_name\": \"Collins\"},{\"id\": 318, \"first_name\": \"Antonio\", \"last_name\": \"Day\"},{\"id\": 431, \"first_name\": \"Todd\", \"last_name\": \"Nichols\"},{\"id\": 292, \"first_name\": \"\", \"last_name\": \"Fuller\"},{\"id\": 777, \"first_name\": \"Adam\", \"last_name\": \"Alexander\"},{\"id\": 121, \"first_name\": \"Lori\", \"last_name\": \"Hudson\"},{\"id\": 176, \"first_name\": \"Alice\", \"last_name\": \"Perez\"},{\"id\": 703, \"first_name\": \"Kathleen\", \"last_name\": \"Lynch\"},{\"id\": 665, \"first_name\": \"Jean\", \"last_name\": \"Brooks\"},{\"id\": 111, \"first_name\": \"Linda\", \"last_name\": \"Baker\"},{\"id\": 957, \"first_name\": \"Linda\", \"last_name\": \"Pierce\"},{\"id\": 390, \"first_name\": \"Louis\", \"last_name\": \"Lane\"},{\"id\": 9, \"first_name\": \"Jose\", \"last_name\": \"Foster\"},{\"id\": 791, \"first_name\": \"Patricia\", \"last_name\": \"Mitchell\"},{\"id\": 773, \"first_name\": \"Sharon\", \"last_name\": \"Peterson\"},{\"id\": 461, \"first_name\": \"Cynthia\", \"last_name\": \"Harris\"},{\"id\": 948, \"first_name\": \"Sandra\", \"last_name\": \"Black\"},{\"id\": 578, \"first_name\": \"Norma\", \"last_name\": \"Sullivan\"},{\"id\": 225, \"first_name\": \"Phyllis\", \"last_name\": \"Wallace\"},{\"id\": 359, \"first_name\": \"Sharon\", \"last_name\": \"Garza\"},{\"id\": 254, \"first_name\": \"Mark\", \"last_name\": \"Jones\"},{\"id\": 211, \"first_name\": \"Judy\", \"last_name\": \"Lane\"},{\"id\": 757, \"first_name\": \"Kevin\", \"last_name\": \"Ruiz\"},{\"id\": 24, \"first_name\": \"Michelle\", \"last_name\": \"Ellis\"},{\"id\": 501, \"first_name\": \"Janice\", \"last_name\": \"Nguyen\"},{\"id\": 907, \"first_name\": \"Keith\", \"last_name\": \"Wheeler\"},{\"id\": 170, \"first_name\": \"Anne\", \"last_name\": \"Reed\"},{\"id\": 887, \"first_name\": \"Stephen\", \"last_name\": \"Griffin\"},{\"id\": 732, \"first_name\": \"Henry\", \"last_name\": \"Lopez\"},{\"id\": 736, \"first_name\": \"Deborah\", \"last_name\": \"Ward\"},{\"id\": 96, \"first_name\": \"Kevin\", \"last_name\": \"Scott\"},{\"id\": 319, \"first_name\": \"Mark\", \"last_name\": \"Burns\"},{\"id\": 705, \"first_name\": \"\", \"last_name\": \"Riley\"},{\"id\": 228, \"first_name\": \"Dennis\", \"last_name\": \"Mcdonald\"},{\"id\": 640, \"first_name\": \"Eugene\", \"last_name\": \"Garza\"},{\"id\": 790, \"first_name\": \"Mark\", \"last_name\": \"Smith\"},{\"id\": 435, \"first_name\": \"Jean\", \"last_name\": \"Dixon\"},{\"id\": 150, \"first_name\": \"Matthew\", \"last_name\": \"Henry\"},{\"id\": 42, \"first_name\": \"Todd\", \"last_name\": \"Alvarez\"},{\"id\": 350, \"first_name\": \"Kevin\", \"last_name\": \"Bishop\"},{\"id\": 910, \"first_name\": \"Anne\", \"last_name\": \"Hicks\"},{\"id\": 962, \"first_name\": \"Arthur\", \"last_name\": \"Knight\"},{\"id\": 46, \"first_name\": \"Deborah\", \"last_name\": \"Armstrong\"},{\"id\": 441, \"first_name\": \"Karen\", \"last_name\": \"Taylor\"},{\"id\": 474, \"first_name\": \"Kathleen\", \"last_name\": \"Matthews\"},{\"id\": 826, \"first_name\": \"Annie\", \"last_name\": \"Vasquez\"},{\"id\": 650, \"first_name\": \"Scott\", \"last_name\": \"Martin\"},{\"id\": 281, \"first_name\": \"Annie\", \"last_name\": \"Ryan\"},{\"id\": 490, \"first_name\": \"Sean\", \"last_name\": \"Gilbert\"},{\"id\": 273, \"first_name\": \"Ann\", \"last_name\": \"Garcia\"},{\"id\": 961, \"first_name\": \"Fred\", \"last_name\": \"Patterson\"},{\"id\": 932, \"first_name\": \"Jane\", \"last_name\": \"Armstrong\"},{\"id\": 64, \"first_name\": \"Dennis\", \"last_name\": \"Ross\"},{\"id\": 998, \"first_name\": \"Nancy\", \"last_name\": \"Morris\"},{\"id\": 183, \"first_name\": \"Emily\", \"last_name\": \"Jordan\"},{\"id\": 272, \"first_name\": \"Maria\", \"last_name\": \"Nelson\"},{\"id\": 825, \"first_name\": \"Sandra\", \"last_name\": \"Murray\"},{\"id\": 926, \"first_name\": \"Diane\", \"last_name\": \"Ruiz\"},{\"id\": 693, \"first_name\": \"Aaron\", \"last_name\": \"Tucker\"},{\"id\": 158, \"first_name\": \"Howard\", \"last_name\": \"Jones\"},{\"id\": 463, \"first_name\": \"Virginia\", \"last_name\": \"Wright\"},{\"id\": 440, \"first_name\": \"James\", \"last_name\": \"Mitchell\"},{\"id\": 392, \"first_name\": \"Carlos\", \"last_name\": \"Robertson\"},{\"id\": 307, \"first_name\": \"Gerald\", \"last_name\": \"Morales\"},{\"id\": 742, \"first_name\": \"Amy\", \"last_name\": \"Moore\"},{\"id\": 598, \"first_name\": \"Deborah\", \"last_name\": \"Lee\"},{\"id\": 134, \"first_name\": \"Henry\", \"last_name\": \"Mccoy\"},{\"id\": 916, \"first_name\": \"Raymond\", \"last_name\": \"Hawkins\"},{\"id\": 129, \"first_name\": \"Kathryn\", \"last_name\": \"Stewart\"},{\"id\": 385, \"first_name\": \"Cheryl\", \"last_name\": \"Gordon\"},{\"id\": 248, \"first_name\": \"Albert\", \"last_name\": \"Robinson\"},{\"id\": 184, \"first_name\": \"Angela\", \"last_name\": \"Cunningham\"},{\"id\": 884, \"first_name\": \"David\", \"last_name\": \"Berry\"},{\"id\": 971, \"first_name\": \"Karen\", \"last_name\": \"Garrett\"},{\"id\": 955, \"first_name\": \"Irene\", \"last_name\": \"Burns\"},{\"id\": 809, \"first_name\": \"Julia\", \"last_name\": \"Duncan\"},{\"id\": 877, \"first_name\": \"Frances\", \"last_name\": \"Ray\"},{\"id\": 564, \"first_name\": \"Alice\", \"last_name\": \"Henderson\"},{\"id\": 858, \"first_name\": \"Brandon\", \"last_name\": \"Mills\"},{\"id\": 988, \"first_name\": \"Juan\", \"last_name\": \"Fuller\"},{\"id\": 421, \"first_name\": \"Marie\", \"last_name\": \"Bailey\"},{\"id\": 528, \"first_name\": \"Teresa\", \"last_name\": \"Rose\"},{\"id\": 58, \"first_name\": \"Arthur\", \"last_name\": \"Berry\"},{\"id\": 247, \"first_name\": \"Sara\", \"last_name\": \"Webb\"},{\"id\": 896, \"first_name\": \"Jane\", \"last_name\": \"Patterson\"},{\"id\": 720, \"first_name\": \"Todd\", \"last_name\": \"James\"},{\"id\": 892, \"first_name\": \"Mark\", \"last_name\": \"Hansen\"},{\"id\": 808, \"first_name\": \"Walter\", \"last_name\": \"Little\"},{\"id\": 539, \"first_name\": \"Pamela\", \"last_name\": \"Willis\"},{\"id\": 187, \"first_name\": \"Wayne\", \"last_name\": \"Brown\"},{\"id\": 429, \"first_name\": \"Antonio\", \"last_name\": \"Butler\"},{\"id\": 92, \"first_name\": \"Donald\", \"last_name\": \"Bradley\"},{\"id\": 714, \"first_name\": \"Lori\", \"last_name\": \"Reyes\"},{\"id\": 712, \"first_name\": \"Maria\", \"last_name\": \"Spencer\"},{\"id\": 287, \"first_name\": \"Jack\", \"last_name\": \"Medina\"},{\"id\": 510, \"first_name\": \"Harry\", \"last_name\": \"Welch\"},{\"id\": 347, \"first_name\": \"Christine\", \"last_name\": \"Dunn\"},{\"id\": 261, \"first_name\": \"Kathleen\", \"last_name\": \"Garza\"},{\"id\": 901, \"first_name\": \"Christina\", \"last_name\": \"Ramos\"},{\"id\": 391, \"first_name\": \"Denise\", \"last_name\": \"Flores\"},{\"id\": 581, \"first_name\": \"Jimmy\", \"last_name\": \"Fernandez\"},{\"id\": 67, \"first_name\": \"Jonathan\", \"last_name\": \"Ellis\"},{\"id\": 140, \"first_name\": \"Christopher\", \"last_name\": \"Turner\"},{\"id\": 756, \"first_name\": \"Judith\", \"last_name\": \"Parker\"},{\"id\": 542, \"first_name\": \"Lori\", \"last_name\": \"Foster\"},{\"id\": 51, \"first_name\": \"Ernest\", \"last_name\": \"Carroll\"},{\"id\": 818, \"first_name\": \"Heather\", \"last_name\": \"Shaw\"},{\"id\": 834, \"first_name\": \"Ashley\", \"last_name\": \"Alvarez\"},{\"id\": 482, \"first_name\": \"Joshua\", \"last_name\": \"Hart\"},{\"id\": 198, \"first_name\": \"Pamela\", \"last_name\": \"Tucker\"},{\"id\": 770, \"first_name\": \"Howard\", \"last_name\": \"Jordan\"},{\"id\": 8, \"first_name\": \"Harry\", \"last_name\": \"Howell\"},{\"id\": 336, \"first_name\": \"Keith\", \"last_name\": \"Perez\"},{\"id\": 654, \"first_name\": \"Roger\", \"last_name\": \"Mitchell\"},{\"id\": 738, \"first_name\": \"Juan\", \"last_name\": \"Sims\"},{\"id\": 918, \"first_name\": \"Clarence\", \"last_name\": \"Simmons\"},{\"id\": 560, \"first_name\": \"Norma\", \"last_name\": \"Duncan\"},{\"id\": 340, \"first_name\": \"Stephen\", \"last_name\": \"Perry\"},{\"id\": 954, \"first_name\": \"George\", \"last_name\": \"Howard\"},{\"id\": 857, \"first_name\": \"Paul\", \"last_name\": \"Anderson\"},{\"id\": 950, \"first_name\": \"Bonnie\", \"last_name\": \"Robertson\"},{\"id\": 885, \"first_name\": \"Philip\", \"last_name\": \"Shaw\"},{\"id\": 180, \"first_name\": \"Sharon\", \"last_name\": \"Fields\"},{\"id\": 387, \"first_name\": \"Christine\", \"last_name\": \"Sanchez\"},{\"id\": 491, \"first_name\": \"Daniel\", \"last_name\": \"Jacobs\"},{\"id\": 330, \"first_name\": \"Justin\", \"last_name\": \"Schmidt\"},{\"id\": 588, \"first_name\": \"Benjamin\", \"last_name\": \"Wheeler\"},{\"id\": 338, \"first_name\": \"Richard\", \"last_name\": \"Henderson\"},{\"id\": 196, \"first_name\": \"Lillian\", \"last_name\": \"Perry\"},{\"id\": 853, \"first_name\": \"Bruce\", \"last_name\": \"Anderson\"},{\"id\": 6, \"first_name\": \"Kathryn\", \"last_name\": \"White\"},{\"id\": 260, \"first_name\": \"Marie\", \"last_name\": \"Brooks\"},{\"id\": 302, \"first_name\": \"Jack\", \"last_name\": \"Sims\"},{\"id\": 895, \"first_name\": \"Andrew\", \"last_name\": \"Ferguson\"},{\"id\": 36, \"first_name\": \"Betty\", \"last_name\": \"Carr\"},{\"id\": 114, \"first_name\": \"Richard\", \"last_name\": \"Dixon\"},{\"id\": 286, \"first_name\": \"Rose\", \"last_name\": \"Fox\"},{\"id\": 417, \"first_name\": \"John\", \"last_name\": \"Johnston\"},{\"id\": 412, \"first_name\": \"Jeffrey\", \"last_name\": \"Green\"},{\"id\": 634, \"first_name\": \"Gerald\", \"last_name\": \"Johnston\"},{\"id\": 942, \"first_name\": \"Juan\", \"last_name\": \"Hunt\"},{\"id\": 393, \"first_name\": \"Martin\", \"last_name\": \"Peters\"},{\"id\": 402, \"first_name\": \"Denise\", \"last_name\": \"Brooks\"},{\"id\": 364, \"first_name\": \"Gloria\", \"last_name\": \"Burton\"},{\"id\": 296, \"first_name\": \"Cynthia\", \"last_name\": \"Snyder\"},{\"id\": 579, \"first_name\": \"Jane\", \"last_name\": \"Stevens\"},{\"id\": 186, \"first_name\": \"Teresa\", \"last_name\": \"Hunter\"},{\"id\": 371, \"first_name\": \"Cheryl\", \"last_name\": \"Perkins\"},{\"id\": 492, \"first_name\": \"Ashley\", \"last_name\": \"Day\"},{\"id\": 657, \"first_name\": \"Dennis\", \"last_name\": \"Brooks\"},{\"id\": 47, \"first_name\": \"Daniel\", \"last_name\": \"Mccoy\"},{\"id\": 232, \"first_name\": \"Irene\", \"last_name\": \"Crawford\"},{\"id\": 169, \"first_name\": \"Carol\", \"last_name\": \"Mccoy\"},{\"id\": 484, \"first_name\": \"Susan\", \"last_name\": \"Howell\"},{\"id\": 345, \"first_name\": \"Beverly\", \"last_name\": \"Medina\"},{\"id\": 467, \"first_name\": \"Joyce\", \"last_name\": \"Carpenter\"},{\"id\": 128, \"first_name\": \"Deborah\", \"last_name\": \"Diaz\"},{\"id\": 900, \"first_name\": \"Kathryn\", \"last_name\": \"Cole\"},{\"id\": 914, \"first_name\": \"Ashley\", \"last_name\": \"Cooper\"},{\"id\": 178, \"first_name\": \"Cheryl\", \"last_name\": \"Watson\"},{\"id\": 274, \"first_name\": \"Cheryl\", \"last_name\": \"West\"},{\"id\": 189, \"first_name\": \"Peter\", \"last_name\": \"Bowman\"},{\"id\": 977, \"first_name\": \"Lori\", \"last_name\": \"Porter\"},{\"id\": 960, \"first_name\": \"Jonathan\", \"last_name\": \"Dean\"},{\"id\": 498, \"first_name\": \"Chris\", \"last_name\": \"Bennett\"},{\"id\": 182, \"first_name\": \"Kathy\", \"last_name\": \"Rogers\"},{\"id\": 123, \"first_name\": \"Evelyn\", \"last_name\": \"Sims\"},{\"id\": 7, \"first_name\": \"Samuel\", \"last_name\": \"Holmes\"},{\"id\": 43, \"first_name\": \"Amanda\", \"last_name\": \"Gray\"},{\"id\": 992, \"first_name\": \"Martha\", \"last_name\": \"Howard\"},{\"id\": 517, \"first_name\": \"Kathy\", \"last_name\": \"Martinez\"},{\"id\": 447, \"first_name\": \"Susan\", \"last_name\": \"Wright\"},{\"id\": 611, \"first_name\": \"Donna\", \"last_name\": \"Sullivan\"},{\"id\": 908, \"first_name\": \"Ashley\", \"last_name\": \"Nichols\"},{\"id\": 363, \"first_name\": \"Martha\", \"last_name\": \"Ray\"},{\"id\": 754, \"first_name\": \"Stephanie\", \"last_name\": \"Washington\"},{\"id\": 532, \"first_name\": \"Alice\", \"last_name\": \"Fernandez\"},{\"id\": 771, \"first_name\": \"Harold\", \"last_name\": \"Harrison\"},{\"id\": 325, \"first_name\": \"Stephen\", \"last_name\": \"Hughes\"},{\"id\": 15, \"first_name\": \"Dorothy\", \"last_name\": \"Hudson\"},{\"id\": 805, \"first_name\": \"Gloria\", \"last_name\": \"Dixon\"},{\"id\": 841, \"first_name\": \"Sara\", \"last_name\": \"Allen\"},{\"id\": 668, \"first_name\": \"Billy\", \"last_name\": \"Romero\"},{\"id\": 457, \"first_name\": \"Kathleen\", \"last_name\": \"Garrett\"},{\"id\": 266, \"first_name\": \"Nicholas\", \"last_name\": \"Alvarez\"},{\"id\": 845, \"first_name\": \"Kimberly\", \"last_name\": \"Burton\"},{\"id\": 577, \"first_name\": \"Donald\", \"last_name\": \"Hudson\"},{\"id\": 947, \"first_name\": \"Sandra\", \"last_name\": \"Shaw\"},{\"id\": 796, \"first_name\": \"Jeffrey\", \"last_name\": \"Sullivan\"},{\"id\": 237, \"first_name\": \"Louise\", \"last_name\": \"Turner\"},{\"id\": 786, \"first_name\": \"Rachel\", \"last_name\": \"Carroll\"},{\"id\": 171, \"first_name\": \"Steven\", \"last_name\": \"Graham\"},{\"id\": 931, \"first_name\": \"Janet\", \"last_name\": \"Medina\"},{\"id\": 297, \"first_name\": \"Cynthia\", \"last_name\": \"Banks\"},{\"id\": 488, \"first_name\": \"Jimmy\", \"last_name\": \"Morgan\"},{\"id\": 69, \"first_name\": \"Harold\", \"last_name\": \"Olson\"},{\"id\": 661, \"first_name\": \"Norma\", \"last_name\": \"Diaz\"},{\"id\": 409, \"first_name\": \"Paula\", \"last_name\": \"Lawson\"},{\"id\": 131, \"first_name\": \"William\", \"last_name\": \"Reynolds\"},{\"id\": 981, \"first_name\": \"Bruce\", \"last_name\": \"Wheeler\"},{\"id\": 527, \"first_name\": \"Gloria\", \"last_name\": \"Barnes\"},{\"id\": 422, \"first_name\": \"Arthur\", \"last_name\": \"Anderson\"},{\"id\": 978, \"first_name\": \"Billy\", \"last_name\": \"Young\"},{\"id\": 1000, \"first_name\": \"Julie\", \"last_name\": \"Meyer\"},{\"id\": 624, \"first_name\": \"Julia\", \"last_name\": \"Marshall\"},{\"id\": 320, \"first_name\": \"Alan\", \"last_name\": \"Gutierrez\"},{\"id\": 245, \"first_name\": \"Russell\", \"last_name\": \"Gonzalez\"},{\"id\": 335, \"first_name\": \"Jennifer\", \"last_name\": \"Hill\"},{\"id\": 432, \"first_name\": \"Michael\", \"last_name\": \"Ramos\"},{\"id\": 558, \"first_name\": \"Henry\", \"last_name\": \"Oliver\"},{\"id\": 394, \"first_name\": \"Cynthia\", \"last_name\": \"Jackson\"},{\"id\": 652, \"first_name\": \"Timothy\", \"last_name\": \"Powell\"},{\"id\": 990, \"first_name\": \"Helen\", \"last_name\": \"Snyder\"},{\"id\": 548, \"first_name\": \"Frances\", \"last_name\": \"Cole\"},{\"id\": 561, \"first_name\": \"James\", \"last_name\": \"Jackson\"},{\"id\": 969, \"first_name\": \"Angela\", \"last_name\": \"Bailey\"},{\"id\": 85, \"first_name\": \"Lillian\", \"last_name\": \"Gardner\"},{\"id\": 212, \"first_name\": \"Ann\", \"last_name\": \"Wheeler\"},{\"id\": 44, \"first_name\": \"Sharon\", \"last_name\": \"Simpson\"},{\"id\": 366, \"first_name\": \"Andrea\", \"last_name\": \"Dixon\"},{\"id\": 163, \"first_name\": \"Marie\", \"last_name\": \"Smith\"},{\"id\": 557, \"first_name\": \"Scott\", \"last_name\": \"Gutierrez\"},{\"id\": 629, \"first_name\": \"Jeremy\", \"last_name\": \"Ruiz\"},{\"id\": 586, \"first_name\": \"Michael\", \"last_name\": \"Medina\"},{\"id\": 20, \"first_name\": \"Rebecca\", \"last_name\": \"Bell\"},{\"id\": 996, \"first_name\": \"Dennis\", \"last_name\": \"Harris\"},{\"id\": 433, \"first_name\": \"Emily\", \"last_name\": \"Davis\"},{\"id\": 243, \"first_name\": \"Eugene\", \"last_name\": \"Pierce\"},{\"id\": 313, \"first_name\": \"Joe\", \"last_name\": \"Porter\"},{\"id\": 822, \"first_name\": \"David\", \"last_name\": \"Howell\"},{\"id\": 353, \"first_name\": \"Christopher\", \"last_name\": \"Garrett\"},{\"id\": 61, \"first_name\": \"David\", \"last_name\": \"Sanders\"},{\"id\": 755, \"first_name\": \"Alice\", \"last_name\": \"Hicks\"},{\"id\": 354, \"first_name\": \"Jeffrey\", \"last_name\": \"Marshall\"},{\"id\": 208, \"first_name\": \"Peter\", \"last_name\": \"Russell\"},{\"id\": 459, \"first_name\": \"Roy\", \"last_name\": \"Smith\"},{\"id\": 159, \"first_name\": \"Peter\", \"last_name\": \"Hanson\"},{\"id\": 436, \"first_name\": \"Judith\", \"last_name\": \"Harper\"},{\"id\": 658, \"first_name\": \"Katherine\", \"last_name\": \"Woods\"},{\"id\": 403, \"first_name\": \"Sean\", \"last_name\": \"Sanders\"},{\"id\": 476, \"first_name\": \"Anne\", \"last_name\": \"Garza\"},{\"id\": 348, \"first_name\": \"Amy\", \"last_name\": \"Andrews\"},{\"id\": 536, \"first_name\": \"Jose\", \"last_name\": \"Barnes\"},{\"id\": 911, \"first_name\": \"Louis\", \"last_name\": \"Bell\"},{\"id\": 870, \"first_name\": \"Evelyn\", \"last_name\": \"Wood\"},{\"id\": 917, \"first_name\": \"Bonnie\", \"last_name\": \"Peterson\"},{\"id\": 95, \"first_name\": \"Stephen\", \"last_name\": \"Gutierrez\"},{\"id\": 130, \"first_name\": \"Donald\", \"last_name\": \"Bowman\"},{\"id\": 278, \"first_name\": \"Joseph\", \"last_name\": \"Henderson\"},{\"id\": 493, \"first_name\": \"Anne\", \"last_name\": \"Warren\"},{\"id\": 136, \"first_name\": \"David\", \"last_name\": \"Elliott\"},{\"id\": 282, \"first_name\": \"\", \"last_name\": \"Patterson\"},{\"id\": 798, \"first_name\": \"Keith\", \"last_name\": \"Vasquez\"},{\"id\": 839, \"first_name\": \"Eric\", \"last_name\": \"Scott\"},{\"id\": 19, \"first_name\": \"Clarence\", \"last_name\": \"Lawson\"},{\"id\": 324, \"first_name\": \"Edward\", \"last_name\": \"Wheeler\"},{\"id\": 983, \"first_name\": \"\", \"last_name\": \"Nguyen\"},{\"id\": 993, \"first_name\": \"Patricia\", \"last_name\": \"Henderson\"},{\"id\": 552, \"first_name\": \"Heather\", \"last_name\": \"Williams\"},{\"id\": 758, \"first_name\": \"Joyce\", \"last_name\": \"Mccoy\"},{\"id\": 706, \"first_name\": \"Paul\", \"last_name\": \"Barnes\"},{\"id\": 737, \"first_name\": \"Jesse\", \"last_name\": \"Stanley\"},{\"id\": 843, \"first_name\": \"Jack\", \"last_name\": \"Pierce\"},{\"id\": 814, \"first_name\": \"Rachel\", \"last_name\": \"Gonzalez\"},{\"id\": 785, \"first_name\": \"Daniel\", \"last_name\": \"Spencer\"},{\"id\": 244, \"first_name\": \"Sarah\", \"last_name\": \"Freeman\"},{\"id\": 633, \"first_name\": \"Maria\", \"last_name\": \"Fowler\"},{\"id\": 53, \"first_name\": \"Ralph\", \"last_name\": \"Price\"},{\"id\": 635, \"first_name\": \"Willie\", \"last_name\": \"Dixon\"},{\"id\": 11, \"first_name\": \"Susan\", \"last_name\": \"Perkins\"},{\"id\": 40, \"first_name\": \"Jack\", \"last_name\": \"Flores\"},{\"id\": 670, \"first_name\": \"Irene\", \"last_name\": \"Hughes\"},{\"id\": 149, \"first_name\": \"Gregory\", \"last_name\": \"Edwards\"},{\"id\": 683, \"first_name\": \"Joshua\", \"last_name\": \"Ramirez\"},{\"id\": 226, \"first_name\": \"James\", \"last_name\": \"Austin\"},{\"id\": 659, \"first_name\": \"Doris\", \"last_name\": \"Welch\"},{\"id\": 479, \"first_name\": \"Joseph\", \"last_name\": \"Gordon\"},{\"id\": 379, \"first_name\": \"Martha\", \"last_name\": \"Simmons\"},{\"id\": 730, \"first_name\": \"Anne\", \"last_name\": \"Perez\"},{\"id\": 426, \"first_name\": \"Lois\", \"last_name\": \"Green\"},{\"id\": 437, \"first_name\": \"Virginia\", \"last_name\": \"Robinson\"},{\"id\": 162, \"first_name\": \"Steve\", \"last_name\": \"Spencer\"},{\"id\": 370, \"first_name\": \"Roger\", \"last_name\": \"Gilbert\"},{\"id\": 708, \"first_name\": \"Judy\", \"last_name\": \"Young\"},{\"id\": 33, \"first_name\": \"Christina\", \"last_name\": \"Mason\"},{\"id\": 591, \"first_name\": \"Rose\", \"last_name\": \"Garrett\"},{\"id\": 779, \"first_name\": \"Richard\", \"last_name\": \"Hunt\"},{\"id\": 681, \"first_name\": \"Betty\", \"last_name\": \"Hamilton\"},{\"id\": 173, \"first_name\": \"Amy\", \"last_name\": \"Garza\"},{\"id\": 293, \"first_name\": \"Amy\", \"last_name\": \"Cook\"},{\"id\": 920, \"first_name\": \"Johnny\", \"last_name\": \"Brown\"},{\"id\": 876, \"first_name\": \"Samuel\", \"last_name\": \"Hughes\"},{\"id\": 4, \"first_name\": \"Denise\", \"last_name\": \"Riley\"},{\"id\": 525, \"first_name\": \"Elizabeth\", \"last_name\": \"Porter\"},{\"id\": 958, \"first_name\": \"Louis\", \"last_name\": \"Griffin\"},{\"id\": 454, \"first_name\": \"Ashley\", \"last_name\": \"Crawford\"},{\"id\": 68, \"first_name\": \"Rachel\", \"last_name\": \"Price\"},{\"id\": 761, \"first_name\": \"Kathleen\", \"last_name\": \"Cook\"},{\"id\": 599, \"first_name\": \"Sean\", \"last_name\": \"Garcia\"},{\"id\": 939, \"first_name\": \"Keith\", \"last_name\": \"Hernandez\"},{\"id\": 763, \"first_name\": \"Amanda\", \"last_name\": \"Miller\"},{\"id\": 664, \"first_name\": \"Kathleen\", \"last_name\": \"Torres\"},{\"id\": 569, \"first_name\": \"Heather\", \"last_name\": \"Johnson\"},{\"id\": 768, \"first_name\": \"Gregory\", \"last_name\": \"James\"},{\"id\": 584, \"first_name\": \"Lois\", \"last_name\": \"Ross\"},{\"id\": 424, \"first_name\": \"Jesse\", \"last_name\": \"Kim\"},{\"id\": 405, \"first_name\": \"Gloria\", \"last_name\": \"Morrison\"},{\"id\": 497, \"first_name\": \"Harry\", \"last_name\": \"Howell\"},{\"id\": 850, \"first_name\": \"Betty\", \"last_name\": \"Elliott\"},{\"id\": 862, \"first_name\": \"Paul\", \"last_name\": \"Garcia\"},{\"id\": 762, \"first_name\": \"Brian\", \"last_name\": \"Sanders\"},{\"id\": 724, \"first_name\": \"Katherine\", \"last_name\": \"Burke\"},{\"id\": 837, \"first_name\": \"Judith\", \"last_name\": \"Price\"},{\"id\": 21, \"first_name\": \"Diane\", \"last_name\": \"Stevens\"},{\"id\": 593, \"first_name\": \"Rebecca\", \"last_name\": \"Burke\"},{\"id\": 48, \"first_name\": \"Jean\", \"last_name\": \"Flores\"},{\"id\": 630, \"first_name\": \"Sarah\", \"last_name\": \"George\"},{\"id\": 280, \"first_name\": \"Andrea\", \"last_name\": \"Mcdonald\"},{\"id\": 157, \"first_name\": \"\", \"last_name\": \"Rose\"},{\"id\": 938, \"first_name\": \"Kimberly\", \"last_name\": \"Dixon\"},{\"id\": 869, \"first_name\": \"Mildred\", \"last_name\": \"Martinez\"},{\"id\": 709, \"first_name\": \"Brenda\", \"last_name\": \"Hamilton\"},{\"id\": 227, \"first_name\": \"Judith\", \"last_name\": \"Mason\"},{\"id\": 729, \"first_name\": \"John\", \"last_name\": \"Hanson\"},{\"id\": 217, \"first_name\": \"Jacqueline\", \"last_name\": \"Long\"},{\"id\": 152, \"first_name\": \"Victor\", \"last_name\": \"Ray\"},{\"id\": 233, \"first_name\": \"Jesse\", \"last_name\": \"Rivera\"},{\"id\": 508, \"first_name\": \"Nicole\", \"last_name\": \"Mitchell\"},{\"id\": 270, \"first_name\": \"Melissa\", \"last_name\": \"Fernandez\"},{\"id\": 99, \"first_name\": \"Russell\", \"last_name\": \"Fields\"},{\"id\": 974, \"first_name\": \"Rebecca\", \"last_name\": \"Stanley\"},{\"id\": 574, \"first_name\": \"Maria\", \"last_name\": \"Wood\"},{\"id\": 79, \"first_name\": \"Linda\", \"last_name\": \"Shaw\"},{\"id\": 819, \"first_name\": \"Brenda\", \"last_name\": \"Ford\"},{\"id\": 820, \"first_name\": \"Ruth\", \"last_name\": \"Harrison\"},{\"id\": 774, \"first_name\": \"Jose\", \"last_name\": \"Fisher\"},{\"id\": 328, \"first_name\": \"Lisa\", \"last_name\": \"Mason\"},{\"id\": 295, \"first_name\": \"Debra\", \"last_name\": \"Harvey\"},{\"id\": 415, \"first_name\": \"Donald\", \"last_name\": \"Fowler\"},{\"id\": 710, \"first_name\": \"Ashley\", \"last_name\": \"Alvarez\"},{\"id\": 122, \"first_name\": \"Brandon\", \"last_name\": \"Fernandez\"},{\"id\": 715, \"first_name\": \"Howard\", \"last_name\": \"Bishop\"},{\"id\": 645, \"first_name\": \"Janet\", \"last_name\": \"Henry\"},{\"id\": 76, \"first_name\": \"Carolyn\", \"last_name\": \"Nelson\"},{\"id\": 647, \"first_name\": \"Lois\", \"last_name\": \"Alvarez\"},{\"id\": 502, \"first_name\": \"Rose\", \"last_name\": \"Hudson\"},{\"id\": 305, \"first_name\": \"Catherine\", \"last_name\": \"Kennedy\"},{\"id\": 848, \"first_name\": \"Ruth\", \"last_name\": \"Alvarez\"},{\"id\": 456, \"first_name\": \"Carlos\", \"last_name\": \"Day\"},{\"id\": 531, \"first_name\": \"Kathy\", \"last_name\": \"Weaver\"},{\"id\": 407, \"first_name\": \"Brenda\", \"last_name\": \"Berry\"},{\"id\": 399, \"first_name\": \"Fred\", \"last_name\": \"Patterson\"},{\"id\": 190, \"first_name\": \"Randy\", \"last_name\": \"Bishop\"},{\"id\": 238, \"first_name\": \"Lillian\", \"last_name\": \"Griffin\"},{\"id\": 146, \"first_name\": \"Patrick\", \"last_name\": \"Thompson\"},{\"id\": 250, \"first_name\": \"Gloria\", \"last_name\": \"Cox\"},{\"id\": 223, \"first_name\": \"George\", \"last_name\": \"Crawford\"},{\"id\": 91, \"first_name\": \"Theresa\", \"last_name\": \"Gonzalez\"},{\"id\": 760, \"first_name\": \"\", \"last_name\": \"Johnson\"},{\"id\": 636, \"first_name\": \"Craig\", \"last_name\": \"Shaw\"},{\"id\": 495, \"first_name\": \"Sara\", \"last_name\": \"Russell\"},{\"id\": 258, \"first_name\": \"Sharon\", \"last_name\": \"Foster\"},{\"id\": 39, \"first_name\": \"Jose\", \"last_name\": \"Murphy\"},{\"id\": 632, \"first_name\": \"Linda\", \"last_name\": \"Austin\"},{\"id\": 865, \"first_name\": \"\", \"last_name\": \"Cole\"},{\"id\": 836, \"first_name\": \"Ruth\", \"last_name\": \"Welch\"},{\"id\": 356, \"first_name\": \"Norma\", \"last_name\": \"Hill\"},{\"id\": 509, \"first_name\": \"Jean\", \"last_name\": \"Jacobs\"},{\"id\": 197, \"first_name\": \"Wanda\", \"last_name\": \"Allen\"},{\"id\": 191, \"first_name\": \"Jane\", \"last_name\": \"Webb\"},{\"id\": 283, \"first_name\": \"Anne\", \"last_name\": \"Diaz\"},{\"id\": 956, \"first_name\": \"Willie\", \"last_name\": \"Knight\"},{\"id\": 172, \"first_name\": \"Virginia\", \"last_name\": \"Wagner\"},{\"id\": 93, \"first_name\": \"Katherine\", \"last_name\": \"Little\"},{\"id\": 481, \"first_name\": \"Alan\", \"last_name\": \"Grant\"},{\"id\": 922, \"first_name\": \"Jonathan\", \"last_name\": \"Carroll\"},{\"id\": 113, \"first_name\": \"Mary\", \"last_name\": \"Cruz\"},{\"id\": 333, \"first_name\": \"Billy\", \"last_name\": \"Ford\"},{\"id\": 308, \"first_name\": \"Mark\", \"last_name\": \"Bishop\"},{\"id\": 603, \"first_name\": \"Elizabeth\", \"last_name\": \"Schmidt\"},{\"id\": 174, \"first_name\": \"Lori\", \"last_name\": \"Reynolds\"},{\"id\": 315, \"first_name\": \"Donald\", \"last_name\": \"Anderson\"},{\"id\": 641, \"first_name\": \"Edward\", \"last_name\": \"Howard\"},{\"id\": 56, \"first_name\": \"Cheryl\", \"last_name\": \"Lawrence\"},{\"id\": 811, \"first_name\": \"Susan\", \"last_name\": \"Adams\"},{\"id\": 537, \"first_name\": \"Ronald\", \"last_name\": \"Butler\"},{\"id\": 964, \"first_name\": \"Jacqueline\", \"last_name\": \"Long\"},{\"id\": 868, \"first_name\": \"Kelly\", \"last_name\": \"Burton\"},{\"id\": 100, \"first_name\": \"Willie\", \"last_name\": \"Weaver\"},{\"id\": 881, \"first_name\": \"Phillip\", \"last_name\": \"Wilson\"},{\"id\": 346, \"first_name\": \"Frances\", \"last_name\": \"Gordon\"},{\"id\": 600, \"first_name\": \"Sarah\", \"last_name\": \"Nguyen\"},{\"id\": 905, \"first_name\": \"Jesse\", \"last_name\": \"Allen\"},{\"id\": 342, \"first_name\": \"Alice\", \"last_name\": \"Harrison\"},{\"id\": 824, \"first_name\": \"Cynthia\", \"last_name\": \"Rogers\"},{\"id\": 644, \"first_name\": \"Jesse\", \"last_name\": \"Armstrong\"},{\"id\": 355, \"first_name\": \"Christina\", \"last_name\": \"Thomas\"},{\"id\": 55, \"first_name\": \"Anna\", \"last_name\": \"Montgomery\"},{\"id\": 902, \"first_name\": \"Janet\", \"last_name\": \"Morgan\"},{\"id\": 343, \"first_name\": \"Rose\", \"last_name\": \"Montgomery\"},{\"id\": 135, \"first_name\": \"Philip\", \"last_name\": \"Butler\"},{\"id\": 972, \"first_name\": \"Alan\", \"last_name\": \"Hudson\"},{\"id\": 263, \"first_name\": \"Russell\", \"last_name\": \"Bennett\"},{\"id\": 255, \"first_name\": \"Lawrence\", \"last_name\": \"Williams\"},{\"id\": 731, \"first_name\": \"Betty\", \"last_name\": \"Gibson\"},{\"id\": 772, \"first_name\": \"Joe\", \"last_name\": \"Day\"},{\"id\": 290, \"first_name\": \"Peter\", \"last_name\": \"Wilson\"},{\"id\": 317, \"first_name\": \"Aaron\", \"last_name\": \"Rose\"},{\"id\": 94, \"first_name\": \"Ruth\", \"last_name\": \"Cooper\"},{\"id\": 915, \"first_name\": \"Christine\", \"last_name\": \"Howell\"},{\"id\": 259, \"first_name\": \"Lisa\", \"last_name\": \"Rodriguez\"},{\"id\": 369, \"first_name\": \"Willie\", \"last_name\": \"Schmidt\"},{\"id\": 807, \"first_name\": \"Phyllis\", \"last_name\": \"Washington\"},{\"id\": 576, \"first_name\": \"David\", \"last_name\": \"Rivera\"},{\"id\": 289, \"first_name\": \"Aaron\", \"last_name\": \"Andrews\"},{\"id\": 309, \"first_name\": \"Todd\", \"last_name\": \"Reid\"},{\"id\": 299, \"first_name\": \"Ann\", \"last_name\": \"Martin\"},{\"id\": 192, \"first_name\": \"Kevin\", \"last_name\": \"Mcdonald\"},{\"id\": 168, \"first_name\": \"Rachel\", \"last_name\": \"Ellis\"},{\"id\": 940, \"first_name\": \"Joe\", \"last_name\": \"Arnold\"},{\"id\": 312, \"first_name\": \"Benjamin\", \"last_name\": \"Burton\"},{\"id\": 18, \"first_name\": \"Stephen\", \"last_name\": \"Wallace\"},{\"id\": 701, \"first_name\": \"Martin\", \"last_name\": \"Ray\"},{\"id\": 639, \"first_name\": \"Jack\", \"last_name\": \"Phillips\"},{\"id\": 275, \"first_name\": \"Daniel\", \"last_name\": \"Clark\"},{\"id\": 451, \"first_name\": \"Alice\", \"last_name\": \"Hanson\"},{\"id\": 410, \"first_name\": \"Kelly\", \"last_name\": \"Nguyen\"},{\"id\": 154, \"first_name\": \"William\", \"last_name\": \"Ramos\"},{\"id\": 311, \"first_name\": \"Rachel\", \"last_name\": \"Fields\"},{\"id\": 863, \"first_name\": \"Chris\", \"last_name\": \"Perkins\"},{\"id\": 575, \"first_name\": \"Jean\", \"last_name\": \"Dixon\"},{\"id\": 344, \"first_name\": \"Joshua\", \"last_name\": \"Austin\"},{\"id\": 613, \"first_name\": \"Johnny\", \"last_name\": \"Burns\"},{\"id\": 769, \"first_name\": \"Wayne\", \"last_name\": \"Bailey\"},{\"id\": 867, \"first_name\": \"Chris\", \"last_name\": \"Alexander\"},{\"id\": 218, \"first_name\": \"Mark\", \"last_name\": \"Crawford\"},{\"id\": 967, \"first_name\": \"Gregory\", \"last_name\": \"Tucker\"},{\"id\": 2, \"first_name\": \"Albert\", \"last_name\": \"Freeman\"},{\"id\": 691, \"first_name\": \"Jack\", \"last_name\": \"Rivera\"},{\"id\": 944, \"first_name\": \"Nicholas\", \"last_name\": \"Lewis\"},{\"id\": 404, \"first_name\": \"\", \"last_name\": \"Flores\"},{\"id\": 105, \"first_name\": \"John\", \"last_name\": \"Stone\"},{\"id\": 707, \"first_name\": \"Sarah\", \"last_name\": \"Stewart\"},{\"id\": 828, \"first_name\": \"Wanda\", \"last_name\": \"Stanley\"},{\"id\": 194, \"first_name\": \"Roy\", \"last_name\": \"Grant\"},{\"id\": 126, \"first_name\": \"Nicole\", \"last_name\": \"Davis\"},{\"id\": 231, \"first_name\": \"Anna\", \"last_name\": \"Banks\"},{\"id\": 321, \"first_name\": \"Raymond\", \"last_name\": \"Fernandez\"},{\"id\": 59, \"first_name\": \"Patricia\", \"last_name\": \"Marshall\"},{\"id\": 997, \"first_name\": \"Gloria\", \"last_name\": \"Hamilton\"},{\"id\": 462, \"first_name\": \"Anthony\", \"last_name\": \"Edwards\"},{\"id\": 249, \"first_name\": \"Bonnie\", \"last_name\": \"Gardner\"},{\"id\": 787, \"first_name\": \"Randy\", \"last_name\": \"Kim\"},{\"id\": 620, \"first_name\": \"Eric\", \"last_name\": \"Ellis\"},{\"id\": 148, \"first_name\": \"Roy\", \"last_name\": \"Griffin\"},{\"id\": 556, \"first_name\": \"Jimmy\", \"last_name\": \"Rodriguez\"},{\"id\": 216, \"first_name\": \"Samuel\", \"last_name\": \"Brooks\"},{\"id\": 753, \"first_name\": \"Frances\", \"last_name\": \"Montgomery\"},{\"id\": 473, \"first_name\": \"Daniel\", \"last_name\": \"Cook\"},{\"id\": 101, \"first_name\": \"Louise\", \"last_name\": \"Hansen\"},{\"id\": 339, \"first_name\": \"Peter\", \"last_name\": \"Coleman\"},{\"id\": 246, \"first_name\": \"Kimberly\", \"last_name\": \"Henderson\"},{\"id\": 332, \"first_name\": \"Martha\", \"last_name\": \"Kelly\"},{\"id\": 547, \"first_name\": \"Michelle\", \"last_name\": \"Duncan\"},{\"id\": 671, \"first_name\": \"Stephen\", \"last_name\": \"Wagner\"},{\"id\": 304, \"first_name\": \"Adam\", \"last_name\": \"Ford\"},{\"id\": 570, \"first_name\": \"Anthony\", \"last_name\": \"Schmidt\"},{\"id\": 49, \"first_name\": \"Lisa\", \"last_name\": \"Snyder\"},{\"id\": 883, \"first_name\": \"Peter\", \"last_name\": \"Gilbert\"},{\"id\": 817, \"first_name\": \"Carl\", \"last_name\": \"Greene\"},{\"id\": 656, \"first_name\": \"Ronald\", \"last_name\": \"Henry\"},{\"id\": 959, \"first_name\": \"Frances\", \"last_name\": \"Martin\"},{\"id\": 12, \"first_name\": \"Alice\", \"last_name\": \"Berry\"},{\"id\": 866, \"first_name\": \"Terry\", \"last_name\": \"Burns\"},{\"id\": 143, \"first_name\": \"Sharon\", \"last_name\": \"Reid\"},{\"id\": 627, \"first_name\": \"Sharon\", \"last_name\": \"Griffin\"},{\"id\": 642, \"first_name\": \"Harry\", \"last_name\": \"Black\"},{\"id\": 530, \"first_name\": \"Ralph\", \"last_name\": \"Wood\"},{\"id\": 941, \"first_name\": \"Randy\", \"last_name\": \"Burke\"},{\"id\": 680, \"first_name\": \"Linda\", \"last_name\": \"Jenkins\"},{\"id\": 623, \"first_name\": \"Linda\", \"last_name\": \"Campbell\"},{\"id\": 22, \"first_name\": \"Lawrence\", \"last_name\": \"Ramos\"},{\"id\": 300, \"first_name\": \"Diana\", \"last_name\": \"Griffin\"},{\"id\": 596, \"first_name\": \"Ryan\", \"last_name\": \"Mills\"},{\"id\": 73, \"first_name\": \"Kimberly\", \"last_name\": \"Wheeler\"},{\"id\": 166, \"first_name\": \"Marie\", \"last_name\": \"Grant\"},{\"id\": 775, \"first_name\": \"Mildred\", \"last_name\": \"Riley\"},{\"id\": 167, \"first_name\": \"Joyce\", \"last_name\": \"Wright\"},{\"id\": 10, \"first_name\": \"Emily\", \"last_name\": \"Stewart\"},{\"id\": 500, \"first_name\": \"Cynthia\", \"last_name\": \"Hernandez\"},{\"id\": 698, \"first_name\": \"Carolyn\", \"last_name\": \"Olson\"},{\"id\": 70, \"first_name\": \"Pamela\", \"last_name\": \"Wagner\"},{\"id\": 220, \"first_name\": \"William\", \"last_name\": \"Green\"},{\"id\": 669, \"first_name\": \"Todd\", \"last_name\": \"Cruz\"},{\"id\": 398, \"first_name\": \"\", \"last_name\": \"Flores\"},{\"id\": 913, \"first_name\": \"Jose\", \"last_name\": \"Washington\"},{\"id\": 23, \"first_name\": \"Gregory\", \"last_name\": \"Barnes\"},{\"id\": 662, \"first_name\": \"Jessica\", \"last_name\": \"Arnold\"},{\"id\": 875, \"first_name\": \"Janet\", \"last_name\": \"Holmes\"},{\"id\": 568, \"first_name\": \"Samuel\", \"last_name\": \"Welch\"},{\"id\": 859, \"first_name\": \"Patrick\", \"last_name\": \"Hart\"},{\"id\": 833, \"first_name\": \"David\", \"last_name\": \"Garza\"},{\"id\": 949, \"first_name\": \"Deborah\", \"last_name\": \"Olson\"},{\"id\": 389, \"first_name\": \"Chris\", \"last_name\": \"Campbell\"},{\"id\": 963, \"first_name\": \"Jessica\", \"last_name\": \"Morales\"},{\"id\": 797, \"first_name\": \"Joshua\", \"last_name\": \"Morrison\"},{\"id\": 45, \"first_name\": \"Bonnie\", \"last_name\": \"Collins\"},{\"id\": 380, \"first_name\": \"Stephanie\", \"last_name\": \"Lewis\"},{\"id\": 31, \"first_name\": \"Antonio\", \"last_name\": \"Berry\"},{\"id\": 728, \"first_name\": \"Carol\", \"last_name\": \"Peterson\"},{\"id\": 408, \"first_name\": \"Diane\", \"last_name\": \"Howard\"},{\"id\": 450, \"first_name\": \"Stephen\", \"last_name\": \"Roberts\"},{\"id\": 567, \"first_name\": \"Chris\", \"last_name\": \"Ross\"},{\"id\": 984, \"first_name\": \"Linda\", \"last_name\": \"Allen\"},{\"id\": 294, \"first_name\": \"William\", \"last_name\": \"Carroll\"},{\"id\": 930, \"first_name\": \"Nicholas\", \"last_name\": \"Knight\"},{\"id\": 469, \"first_name\": \"Dorothy\", \"last_name\": \"Wallace\"},{\"id\": 109, \"first_name\": \"Gloria\", \"last_name\": \"Hamilton\"},{\"id\": 103, \"first_name\": \"Aaron\", \"last_name\": \"Bailey\"},{\"id\": 214, \"first_name\": \"Anthony\", \"last_name\": \"Pierce\"},{\"id\": 504, \"first_name\": \"Joyce\", \"last_name\": \"Willis\"},{\"id\": 75, \"first_name\": \"Catherine\", \"last_name\": \"Gibson\"},{\"id\": 455, \"first_name\": \"Wanda\", \"last_name\": \"Hall\"},{\"id\": 323, \"first_name\": \"Barbara\", \"last_name\": \"Garcia\"},{\"id\": 725, \"first_name\": \"\", \"last_name\": \"Moreno\"},{\"id\": 360, \"first_name\": \"Albert\", \"last_name\": \"Fuller\"},{\"id\": 711, \"first_name\": \"Peter\", \"last_name\": \"Miller\"},{\"id\": 844, \"first_name\": \"Harry\", \"last_name\": \"Sanders\"},{\"id\": 794, \"first_name\": \"Evelyn\", \"last_name\": \"Gutierrez\"},{\"id\": 674, \"first_name\": \"Jennifer\", \"last_name\": \"James\"},{\"id\": 151, \"first_name\": \"Anna\", \"last_name\": \"Clark\"},{\"id\": 119, \"first_name\": \"Craig\", \"last_name\": \"Sullivan\"},{\"id\": 802, \"first_name\": \"Gerald\", \"last_name\": \"Frazier\"},{\"id\": 485, \"first_name\": \"Mary\", \"last_name\": \"Mills\"},{\"id\": 145, \"first_name\": \"Joshua\", \"last_name\": \"Baker\"},{\"id\": 511, \"first_name\": \"William\", \"last_name\": \"Kelley\"},{\"id\": 649, \"first_name\": \"Mary\", \"last_name\": \"Harvey\"},{\"id\": 631, \"first_name\": \"Amy\", \"last_name\": \"Carr\"},{\"id\": 514, \"first_name\": \"Jane\", \"last_name\": \"Lane\"},{\"id\": 445, \"first_name\": \"Eugene\", \"last_name\": \"Warren\"},{\"id\": 41, \"first_name\": \"Walter\", \"last_name\": \"Martinez\"},{\"id\": 458, \"first_name\": \"George\", \"last_name\": \"Graham\"},{\"id\": 734, \"first_name\": \"Heather\", \"last_name\": \"Mason\"},{\"id\": 700, \"first_name\": \"Arthur\", \"last_name\": \"Fernandez\"},{\"id\": 341, \"first_name\": \"Philip\", \"last_name\": \"Hanson\"},{\"id\": 522, \"first_name\": \"Norma\", \"last_name\": \"Medina\"},{\"id\": 327, \"first_name\": \"Gloria\", \"last_name\": \"Lawrence\"},{\"id\": 609, \"first_name\": \"Christine\", \"last_name\": \"Black\"},{\"id\": 110, \"first_name\": \"Kathryn\", \"last_name\": \"Bowman\"},{\"id\": 361, \"first_name\": \"Howard\", \"last_name\": \"Tucker\"},{\"id\": 63, \"first_name\": \"Kevin\", \"last_name\": \"Butler\"},{\"id\": 86, \"first_name\": \"Peter\", \"last_name\": \"Mendoza\"},{\"id\": 72, \"first_name\": \"John\", \"last_name\": \"Ortiz\"},{\"id\": 125, \"first_name\": \"Victor\", \"last_name\": \"Fields\"},{\"id\": 585, \"first_name\": \"Stephanie\", \"last_name\": \"Hall\"},{\"id\": 618, \"first_name\": \"Joe\", \"last_name\": \"Castillo\"},{\"id\": 980, \"first_name\": \"Pamela\", \"last_name\": \"Hunter\"},{\"id\": 118, \"first_name\": \"Randy\", \"last_name\": \"Kelley\"},{\"id\": 991, \"first_name\": \"Russell\", \"last_name\": \"Hunt\"},{\"id\": 686, \"first_name\": \"Tammy\", \"last_name\": \"Jackson\"},{\"id\": 619, \"first_name\": \"Alan\", \"last_name\": \"Gilbert\"},{\"id\": 799, \"first_name\": \"Douglas\", \"last_name\": \"Barnes\"},{\"id\": 580, \"first_name\": \"Gloria\", \"last_name\": \"Willis\"},{\"id\": 310, \"first_name\": \"Roger\", \"last_name\": \"Harvey\"},{\"id\": 414, \"first_name\": \"Clarence\", \"last_name\": \"Perez\"},{\"id\": 181, \"first_name\": \"Jonathan\", \"last_name\": \"Parker\"},{\"id\": 66, \"first_name\": \"Steven\", \"last_name\": \"Pierce\"},{\"id\": 538, \"first_name\": \"\", \"last_name\": \"Richardson\"},{\"id\": 518, \"first_name\": \"Sandra\", \"last_name\": \"Martinez\"},{\"id\": 743, \"first_name\": \"Matthew\", \"last_name\": \"Allen\"},{\"id\": 257, \"first_name\": \"Stephen\", \"last_name\": \"Lawrence\"},{\"id\": 329, \"first_name\": \"Norma\", \"last_name\": \"Fields\"},{\"id\": 438, \"first_name\": \"Debra\", \"last_name\": \"Ward\"},{\"id\": 750, \"first_name\": \"Anne\", \"last_name\": \"Andrews\"},{\"id\": 571, \"first_name\": \"Christine\", \"last_name\": \"Watson\"},{\"id\": 815, \"first_name\": \"Thomas\", \"last_name\": \"Robinson\"},{\"id\": 696, \"first_name\": \"Harry\", \"last_name\": \"Simpson\"},{\"id\": 132, \"first_name\": \"Roger\", \"last_name\": \"Graham\"},{\"id\": 397, \"first_name\": \"Aaron\", \"last_name\": \"Lane\"},{\"id\": 164, \"first_name\": \"Theresa\", \"last_name\": \"Martin\"},{\"id\": 946, \"first_name\": \"Theresa\", \"last_name\": \"Arnold\"},{\"id\": 945, \"first_name\": \"Lois\", \"last_name\": \"Cruz\"},{\"id\": 32, \"first_name\": \"Nicole\", \"last_name\": \"Martinez\"},{\"id\": 269, \"first_name\": \"Michelle\", \"last_name\": \"Reyes\"},{\"id\": 606, \"first_name\": \"Rose\", \"last_name\": \"Cruz\"},{\"id\": 739, \"first_name\": \"Marie\", \"last_name\": \"Edwards\"},{\"id\": 264, \"first_name\": \"Willie\", \"last_name\": \"Hernandez\"},{\"id\": 430, \"first_name\": \"Katherine\", \"last_name\": \"Morris\"},{\"id\": 989, \"first_name\": \"Theresa\", \"last_name\": \"Harrison\"},{\"id\": 420, \"first_name\": \"Ernest\", \"last_name\": \"Ross\"},{\"id\": 830, \"first_name\": \"Melissa\", \"last_name\": \"Ellis\"},{\"id\": 638, \"first_name\": \"Louis\", \"last_name\": \"Phillips\"},{\"id\": 874, \"first_name\": \"Joyce\", \"last_name\": \"Moore\"},{\"id\": 780, \"first_name\": \"Janice\", \"last_name\": \"Wright\"},{\"id\": 452, \"first_name\": \"Sean\", \"last_name\": \"Nguyen\"},{\"id\": 689, \"first_name\": \"Paul\", \"last_name\": \"Duncan\"},{\"id\": 377, \"first_name\": \"Timothy\", \"last_name\": \"Fisher\"},{\"id\": 30, \"first_name\": \"Annie\", \"last_name\": \"Torres\"},{\"id\": 751, \"first_name\": \"Earl\", \"last_name\": \"Sanders\"},{\"id\": 373, \"first_name\": \"Carlos\", \"last_name\": \"Wells\"},{\"id\": 14, \"first_name\": \"Kathy\", \"last_name\": \"Reynolds\"},{\"id\": 541, \"first_name\": \"Wayne\", \"last_name\": \"Reynolds\"},{\"id\": 234, \"first_name\": \"Amanda\", \"last_name\": \"Coleman\"},{\"id\": 702, \"first_name\": \"Teresa\", \"last_name\": \"Hayes\"},{\"id\": 439, \"first_name\": \"Jessica\", \"last_name\": \"Hansen\"},{\"id\": 726, \"first_name\": \"Jimmy\", \"last_name\": \"Barnes\"},{\"id\": 470, \"first_name\": \"Diane\", \"last_name\": \"Edwards\"},{\"id\": 81, \"first_name\": \"Albert\", \"last_name\": \"Pierce\"},{\"id\": 235, \"first_name\": \"Larry\", \"last_name\": \"Gilbert\"},{\"id\": 587, \"first_name\": \"Debra\", \"last_name\": \"Ryan\"},{\"id\": 767, \"first_name\": \"Antonio\", \"last_name\": \"Boyd\"},{\"id\": 108, \"first_name\": \"Lawrence\", \"last_name\": \"Morris\"},{\"id\": 153, \"first_name\": \"Cheryl\", \"last_name\": \"Lynch\"},{\"id\": 161, \"first_name\": \"Melissa\", \"last_name\": \"Murphy\"},{\"id\": 71, \"first_name\": \"Stephanie\", \"last_name\": \"Watkins\"},{\"id\": 535, \"first_name\": \"Samuel\", \"last_name\": \"Gonzales\"},{\"id\": 573, \"first_name\": \"Ann\", \"last_name\": \"Burton\"},{\"id\": 203, \"first_name\": \"Jessica\", \"last_name\": \"Moore\"},{\"id\": 221, \"first_name\": \"Robin\", \"last_name\": \"Montgomery\"},{\"id\": 38, \"first_name\": \"Kathryn\", \"last_name\": \"Lane\"},{\"id\": 229, \"first_name\": \"David\", \"last_name\": \"Bailey\"},{\"id\": 549, \"first_name\": \"Keith\", \"last_name\": \"Cox\"},{\"id\": 268, \"first_name\": \"Sandra\", \"last_name\": \"Adams\"},{\"id\": 951, \"first_name\": \"Dennis\", \"last_name\": \"Hayes\"},{\"id\": 386, \"first_name\": \"Phillip\", \"last_name\": \"Thompson\"},{\"id\": 855, \"first_name\": \"Tammy\", \"last_name\": \"Crawford\"},{\"id\": 177, \"first_name\": \"Norma\", \"last_name\": \"Tucker\"},{\"id\": 515, \"first_name\": \"Benjamin\", \"last_name\": \"Lane\"},{\"id\": 418, \"first_name\": \"Judith\", \"last_name\": \"Kennedy\"},{\"id\": 80, \"first_name\": \"Anna\", \"last_name\": \"Hudson\"},{\"id\": 242, \"first_name\": \"Lisa\", \"last_name\": \"Hill\"},{\"id\": 97, \"first_name\": \"Steven\", \"last_name\": \"Williamson\"},{\"id\": 107, \"first_name\": \"Irene\", \"last_name\": \"Grant\"},{\"id\": 690, \"first_name\": \"Raymond\", \"last_name\": \"Cox\"},{\"id\": 271, \"first_name\": \"Martha\", \"last_name\": \"Reid\"},{\"id\": 34, \"first_name\": \"Margaret\", \"last_name\": \"Barnes\"},{\"id\": 165, \"first_name\": \"Harold\", \"last_name\": \"Foster\"},{\"id\": 540, \"first_name\": \"Timothy\", \"last_name\": \"Palmer\"},{\"id\": 616, \"first_name\": \"Ruth\", \"last_name\": \"White\"},{\"id\": 682, \"first_name\": \"Annie\", \"last_name\": \"Henderson\"},{\"id\": 903, \"first_name\": \"Ann\", \"last_name\": \"Dean\"},{\"id\": 894, \"first_name\": \"Richard\", \"last_name\": \"Foster\"},{\"id\": 572, \"first_name\": \"Maria\", \"last_name\": \"Rose\"},{\"id\": 374, \"first_name\": \"Aaron\", \"last_name\": \"Snyder\"},{\"id\": 695, \"first_name\": \"Angela\", \"last_name\": \"Simpson\"},{\"id\": 741, \"first_name\": \"Ann\", \"last_name\": \"Martinez\"},{\"id\": 543, \"first_name\": \"Jack\", \"last_name\": \"Hart\"},{\"id\": 923, \"first_name\": \"Jack\", \"last_name\": \"Rogers\"},{\"id\": 306, \"first_name\": \"Denise\", \"last_name\": \"Jackson\"},{\"id\": 733, \"first_name\": \"Richard\", \"last_name\": \"Allen\"},{\"id\": 193, \"first_name\": \"Julia\", \"last_name\": \"Anderson\"},{\"id\": 717, \"first_name\": \"Rachel\", \"last_name\": \"Shaw\"},{\"id\": 745, \"first_name\": \"Amy\", \"last_name\": \"Simmons\"},{\"id\": 625, \"first_name\": \"Heather\", \"last_name\": \"Wallace\"},{\"id\": 759, \"first_name\": \"Norma\", \"last_name\": \"Jones\"},{\"id\": 604, \"first_name\": \"Christine\", \"last_name\": \"Wilson\"},{\"id\": 449, \"first_name\": \"Eugene\", \"last_name\": \"Barnes\"},{\"id\": 507, \"first_name\": \"Laura\", \"last_name\": \"Stanley\"},{\"id\": 513, \"first_name\": \"Wayne\", \"last_name\": \"Ward\"},{\"id\": 719, \"first_name\": \"Peter\", \"last_name\": \"Powell\"},{\"id\": 465, \"first_name\": \"Patricia\", \"last_name\": \"Freeman\"},{\"id\": 112, \"first_name\": \"Nicole\", \"last_name\": \"Burns\"},{\"id\": 666, \"first_name\": \"Victor\", \"last_name\": \"Arnold\"},{\"id\": 185, \"first_name\": \"Raymond\", \"last_name\": \"Gonzalez\"},{\"id\": 425, \"first_name\": \"Ashley\", \"last_name\": \"Miller\"}]";

    // relationships
    public static final Relationship REL_SUCCESS = new Relationship.Builder()
            .name("success")
            .description("Json objects that are successfully indexed in elasticsearch are transferred to this relationship")
            .build();

    public static final Relationship REL_FAILURE = new Relationship.Builder()
            .name("failure")
            .description(
                    "Json objects that are successfully indexed in elasticsearch are transferred to this relationship")
            .build();
    private final Set<Relationship> relationships;

    // properties
    public static final PropertyDescriptor INDEX_NAME = new PropertyDescriptor.Builder()
            .name("IndexName")
            .description("The name of the index")
            .required(true)
            .addValidator(StandardValidators.NON_EMPTY_VALIDATOR)
            .expressionLanguageSupported(true)
            .build();
    public static final PropertyDescriptor TYPE = new PropertyDescriptor.Builder()
            .name("Type")
            .description("Elasticsearch type")
            .required(true)
            .addValidator(StandardValidators.NON_EMPTY_VALIDATOR)
            .expressionLanguageSupported(true)
            .build();
    public static final PropertyDescriptor HOST_NAME = new PropertyDescriptor.Builder()
            .name("HostName")
            .description("Elasticsearch host")
            .required(true)
            .addValidator(StandardValidators.NON_EMPTY_VALIDATOR)
            .expressionLanguageSupported(true)
            .build();

    private final List<PropertyDescriptor> propDescriptors;

    public IndexElasticSearch() {
        final Set<Relationship> r = new HashSet<>();
        r.add(REL_SUCCESS);
        r.add(REL_FAILURE);
        relationships = Collections.unmodifiableSet(r);

        final List<PropertyDescriptor> pds = new ArrayList<>();
        pds.add(INDEX_NAME);
        pds.add(TYPE);
        pds.add(HOST_NAME);
        propDescriptors = Collections.unmodifiableList(pds);
    }

    @Override
    public Set<Relationship> getRelationships() {
        return relationships;
    }

    @Override
    protected List<PropertyDescriptor> getSupportedPropertyDescriptors() {
        return propDescriptors;
    }

    @Override
    public void onTrigger(final ProcessContext context, final ProcessSession session) throws ProcessException {
        final ProcessorLog logger = getLogger();
        FlowFile incoming = session.get();
        FlowFile outgoing = (incoming == null ? session.create() : incoming);
        try {
              /* Configuration parameters for spark launcher */
            String indexName = context.getProperty(INDEX_NAME).evaluateAttributeExpressions(outgoing).getValue();
            String type = context.getProperty(TYPE).evaluateAttributeExpressions(outgoing).getValue();
            String hostName = context.getProperty(HOST_NAME).evaluateAttributeExpressions(outgoing).getValue();

            final StringBuffer sb = new StringBuffer();
            session.read(incoming, new InputStreamCallback() {

                @Override
                public void process(InputStream in) throws IOException {
                    sb.append(IOUtils.toString(in));
                }

            });

            logger.info("The json that was received is: " + sb.toString());

            sendToElasticSearch(sb.toString(), hostName, indexName, type);

             /* Wait for job completion */
            boolean success = true;
            if (!success) {
                logger.info("*** Completed with failed status ");
                session.transfer(outgoing, REL_FAILURE);
            }else{
                logger.info("*** Completed with status ");
                session.transfer(outgoing, REL_SUCCESS);
            }
        } catch (final Exception e ) {
            e.printStackTrace();
            logger.error("Unable to execute Elasticsearch job", new Object[]{incoming, e});
            session.transfer(incoming, REL_FAILURE);
        }

    }

    private boolean sendToElasticSearch(String json, String hostName, String index, String type) throws Exception {
        final ProcessorLog logger = getLogger();
        Settings settings = Settings.settingsBuilder()
                .put("cluster.name", "demo-cluster").build();
        Client client = TransportClient.builder().settings(settings).build()
                .addTransportAddress(new InetSocketTransportAddress(InetAddress.getByName(hostName), 9300));

        JSONArray array = new JSONArray(json);

        for (int i = 0; i < array.length(); i++) {
            JSONObject jsonObj = array.getJSONObject(i);
            //System.out.println(jsonObj.getString("id"));
            //System.out.println(jsonObj.getString("first_name"));
            //BulkRequestBuilder bulkRequest = client.prepareBulk();
                /*IndexResponse response = client.prepareIndex("mysource", "myentity", jsonObj.getString("id"))
                        .setSource(jsonBuilder()
                                        .startObject()
                                        .field("id", jsonObj.getString("id"))
                                        .field("first_ame", jsonObj.getString("first_name"))
                                        .field("last_name", jsonObj.getString("last_name"))
                                        .endObject()
                        )
                        .get();*/
            IndexRequest indexRequest = new IndexRequest(index, type, jsonObj.getString("id"))
                    .source(jsonBuilder()
                            .startObject()
                            .field("id", jsonObj.getString("id"))
                            .field("first_name", jsonObj.getString("first_name"))
                            .field("last_name", jsonObj.getString("last_name"))
                            .field("post_date", new Date())
                            .endObject());
            UpdateRequest updateRequest = new UpdateRequest(index, type, jsonObj.getString("id"))
                    .doc(jsonBuilder()
                                    .startObject()
                                    .field("id", jsonObj.getString("id"))
                                    .field("first_name", jsonObj.getString("first_name"))
                                    .field("last_name", jsonObj.getString("last_name"))
                                    .field("post_date", new Date())
                                    .endObject()
                    )
                    .upsert(indexRequest);
            UpdateResponse response = client.update(updateRequest).get();
            //System.out.println("Total: " + response.getShardInfo().getTotal() + " Successful: " + response.getShardInfo().getSuccessful() + " failed: " + response.getShardInfo().getFailed());
            if (response.isCreated()) {
                logger.debug("Created new doc");
            }
            if (response.getShardInfo().getFailed() > 0) {
                logger.error("Error occurred for id: " + jsonObj.getString("id"));
                return false;
            }

        }
        return true;
    }
}
