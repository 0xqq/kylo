<div layout="row" flex ng-controller="ServiceHealthDetailsController as vm">
    <card-layout flex header-css="filter-header">
        <header-section tba-card-filter-header transclude-to="head" flex layout card-title="vm.cardTitle" page-name="{{vm.pageName}}" view-type="vm.viewType" sort-options="vm.sortOptions" on-selected-option="vm.selectedTableOption" filter-model="vm.filter">

        </header-section>
        <body-section transclude-to="body">
            <md-divider></md-divider>
            <div ng-hide="vm.viewType != 'list'" ng-show="vm.viewType == 'list'">
                <md-list flex layout-fill ng-show="vm.loading == false" ng-hide class="list-item-table">
                    <md-list-item layout="row" dir-paginate="component in vm.service.components|orderBy:vm.paginationData.sort |filter:vm.filter|itemsPerPage:vm.paginationData.rowsPerPage" pagination-id="vm.paginationId()" ng-click="vm.serviceComponentDetails($event,component)">
                        <div layout="row" layout-fill>
                        <div flex="20" layout="column" style="overflow:hidden; text-overflow:ellipsis;"  class="item-column md-list-item-text">
                                   <span class="item-title">
                                      {{component.name}}
                                   </span>
                                   <span class="{{component.iconstyle}} column-title-bottom" >
                                       <ng-md-icon icon="{{component.icon}}" size="20" options='{"rotation": "clock"}' ></ng-md-icon>
                                     {{component.healthText}}
                                   </span>
                        </div>
                        <div flex="50" flex-sm="80" flex-xs="80" layout="column"  class="item-column md-list-item-text">
                                   <span class="item-title">{{component.message}}
                                   </span>
                            <span class="column-title column-title-bottom">Message</span>
                        </div>
                            <div flex="10" layout="column"  class="item-column md-list-item-text">
                                    <span class="item-title" ng-if="component.alerts.length >1 || component.alerts.length == 0">
                                        {{component.alerts.length}} Alerts
                                    </span>
                                      <span class="item-title" ng-if="component.alerts.length == 1" >
                                        {{component.alerts.length}} Alert
                                    </span>
                                <span class="column-title column-title-bottom">Alerts</span>
                            </div>
                        <div flex="20" layout="column" hide show-gt-md class="item-column md-list-item-text">
                            <span class="item-title">{{component.checkDate | date : "MM/dd/yyyy 'at' h:mm"}}</span>
                            <span class="column-title column-title-bottom">Last Checked</span>
                        </div>
                        <md-divider ng-if="!$last"></md-divider>
                        </div>
                    </md-list-item>
                    <md-item  ng-show="vm.service.components.length == 0">
                        No results found
                    </md-item >
                    <md-divider></md-divider>
                    <md-list-item   layout-align="end center"  layout-row class="pagination-list-item">
                        <dir-pagination-controls pagination-id="vm.paginationId()"
                                                 auto-hide="false"
                                                 max-size="5"
                                                 direction-links="true"
                                                 boundary-links="false"
                                                 template-url="js/vendor/dirPagination/dirPagination.tpl.html"
                                                 current-page="vm.currentPage"
                                                 on-page-change="vm.onPaginationChange(newPageNumber)"
                                                 label="Rows per page"
                                                 rows-per-page="vm.paginationData.rowsPerPage"
                                                 rows-per-page-options="vm.paginationData.rowsPerPageOptions"
                                                 class="pagination-row">
                        </dir-pagination-controls>
                    </md-list-item>


                </md-list>
            </div>
            <div ng-hide="vm.viewType != 'table'" ng-show="vm.viewType == 'table'">

                <md-table-container>
                    <table md-table md-progress="vm.deferred.promise">
                        <thead md-head md-order="vm.paginationData.sort" md-on-reorder="vm.onOrderChange" >
                        <tr md-row>
                            <th md-column name="Name" order-by="name">Name</th>
                            <th md-column  name="Status" order-by="state">Status</th>
                            <th md-column  name="Message" order-by="message">Message</th>
                            <th md-column  name="Alerts">Alerts</th>
                            <th md-column  name="Last Checked" order-by="checkDate"  hide show-gt-md >Last Checked</th>
                        </tr>
                        </thead>
                        <tbody md-body>
                        <tr md-row ng-repeat="component in vm.service.components| orderBy: vm.paginationData.sort | filter:vm.filter | limitTo: vm.paginationData.rowsPerPage: (vm.currentPage - 1) * vm.paginationData.rowsPerPage" ng-click="vm.serviceComponentDetails($event,component)">
                        <td md-cell>{{component.name}}</td>
                        <td md-cell>
                            <span >
                                       <ng-md-icon icon="{{component.icon}}" class="{{component.iconstyle}}" size="20" options='{"rotation": "clock"}' ></ng-md-icon>
                                     {{component.healthText}}</span>

                        </td>
                        <td md-cell>
                            {{component.message}}
                        </td>
                        <td md-cell>
                            {{component.alerts.length}}
                        </td>
                        <td md-cell hide show-gt-md >{{component.checkDate | date : "MM/dd/yyyy 'at' h:mm"}}</td>
                        </tr>
                        </tbody>
                    </table>
                </md-table-container>

                <md-table-pagination md-limit="vm.paginationData.rowsPerPage" md-page="vm.currentPage" md-total="{{vm.service.componentsCount}}" md-on-paginate="vm.onPaginationChange" md-limit-options="[5,10,20,50,'All']"></md-table-pagination>

            </div>
        </body-section>
    </card-layout>
    <card-layout flex="20">
            <header-section transclude-to="head">
                <div class="card-title">Service Details</div>
            </header-section>
            <body-section transclude-to="body">
                <md-list flex layout-fill layout="column" class="list-item-table">
                    <md-list-item>
                        <div layout="column"  class="item-column md-list-item-text">
                             <span  class="item-title">{{vm.serviceName}}</span>
                               <span class="{{vm.service.iconstyle}} column-title-bottom" ><ng-md-icon icon="{{vm.service.icon}}" size="20" options='{"rotation": "clock"}' ></ng-md-icon>
                                     {{vm.service.healthText}}</span>
                           </div>
                        </md-list-item>
                    <md-divider></md-divider>
                    <md-list-item>
                        <div layout="column"  class="item-column md-list-item-text">
                            <span class="item-title">{{vm.service.checkDate | date : "MM/dd/yyyy 'at' h:mm"}}</span>
                            <span class="column-title column-title-bottom">Last Checked</span>
                        </div>
                    </md-list-item>
                    </md-list>
                </body-section>
        </card-layout>
</div>